{% extends "base.html" %}

{% block title %}Оформление заказа - CodeLaft Store{% endblock %}

{% block content %}
<div class="checkout-container">
    <h1 class="checkout-title">Оформление заказа</h1>
    
    <div class="checkout-grid">
        <div class="checkout-form">
            <h2>Данные для заказа</h2>
            
            <form method="POST" enctype="multipart/form-data">
                <div class="order-summary">
                    <h3>{{ product.name }}</h3>
                    <p class="order-price">{{ product.price }} USDT</p>
                    <p class="order-type">
                        {% if product.price_type == 'subscription' %}
                            Тип: Подписка на {{ product.subscription_days }} дней
                        {% else %}
                            Тип: Единоразовая покупка
                        {% endif %}
                    </p>
                </div>
                
                {% if form_fields %}
                <div class="form-fields">
                    <h3>Заполните данные</h3>
                    {% for field in form_fields %}
                    <div class="form-group">
                        <label for="{{ field.name }}">{{ field.label }}{% if field.required %} *{% endif %}</label>
                        
                        {% if field.type == 'text' %}
                            <input type="text" 
                                   id="{{ field.name }}" 
                                   name="{{ field.name }}" 
                                   {% if field.required %}required{% endif %}
                                   placeholder="Введите {{ field.label|lower }}">
                        
                        {% elif field.type == 'email' %}
                            <input type="email" 
                                   id="{{ field.name }}" 
                                   name="{{ field.name }}" 
                                   {% if field.required %}required{% endif %}
                                   placeholder="email@example.com">
                        
                        {% elif field.type == 'textarea' %}
                            <textarea id="{{ field.name }}" 
                                      name="{{ field.name }}" 
                                      {% if field.required %}required{% endif %}
                                      rows="4"
                                      placeholder="Введите {{ field.label|lower }}"></textarea>
                        
                        {% elif field.type == 'file' %}
                            <input type="file" 
                                   id="{{ field.name }}" 
                                   name="{{ field.name }}" 
                                   {% if field.required %}required{% endif %}
                                   accept=".jpg,.jpeg,.png,.pdf,.txt,.zip,.rar">
                        
                        {% elif field.type == 'select' %}
                            <select id="{{ field.name }}" 
                                    name="{{ field.name }}" 
                                    {% if field.required %}required{% endif %}>
                                <option value="">Выберите вариант</option>
                                {% if field.options %}
                                    {% for option in field.options.split(',') %}
                                    <option value="{{ option.strip() }}">{{ option.strip() }}</option>
                                    {% endfor %}
                                {% endif %}
                            </select>
                        
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="no-fields-notice">
                    <p>Для этого товара не требуется дополнительная информация.</p>
                </div>
                {% endif %}
                
                <div class="checkout-actions">
                    <button type="submit" class="btn btn-primary btn-large">
                        <i class="fas fa-arrow-right"></i> Перейти к оплате
                    </button>
                    <a href="{{ url_for('product_detail', product_id=product.id) }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Назад
                    </a>
                </div>
            </form>
        </div>
        
        <div class="checkout-sidebar">
            <div class="sidebar-card">
                <h3>Информация о покупке</h3>
                <div class="sidebar-item">
                    <span>Товар:</span>
                    <strong>{{ product.name }}</strong>
                </div>
                <div class="sidebar-item">
                    <span>Цена:</span>
                    <strong>{{ product.price }} USDT</strong>
                </div>
                <div class="sidebar-item">
                    <span>Тип:</span>
                    <strong>
                        {% if product.price_type == 'subscription' %}
                            Подписка
                        {% else %}
                            Одноразово
                        {% endif %}
                    </strong>
                </div>
                <div class="sidebar-item">
                    <span>Доставка:</span>
                    <strong>Мгновенно</strong>
                </div>
                
                <div class="payment-info">
                    <h4>Как оплатить:</h4>
                    <ol>
                        <li>Заполните форму и перейдите к оплате</li>
                        <li>Скопируйте адрес кошелька</li>
                        <li>Отправьте точную сумму USDT TRC20</li>
                        <li>Подтвердите платеж на сайте</li>
                        <li>Получите товар мгновенно!</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}